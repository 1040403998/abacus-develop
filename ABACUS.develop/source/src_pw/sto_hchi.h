#ifndef INCLUDE_STO_HCHI_H
#define INCLUDE_STO_HCHI_H
#include "tools.h"

//-----------------------------------------------------
// H * chi
// chi: stochastic wave functions
//
// H: the Hamiltonian matrix, which is decomposed 
// into the electron kinetic, effective potential V(r),
// and the non-local pseudopotentials.
// The effective potential = Local pseudopotential +
// Hartree potential + Exchange-correlation potential
//------------------------------------------------------

class Stochastic_Hchi
{

	public:

    // constructor and deconstructor
    Stochastic_Hchi();
    ~Stochastic_Hchi();
	void init();
	int nrxx;
	int nx,ny,nz;
	fftw_plan pf,pb;
	bool initplan,initchi;
	complex<double> *tmpchi1,*tmpchi2;
	void Hchi(complex<double>* chiin, complex<double> *chiout);
	
	

	private:

	// chi should be orthogonal to psi (generated by diaganolization methods,
	// such as CG)
	void orthogonal_to_psi();


};

#endif// Eelectrons_Hchi
